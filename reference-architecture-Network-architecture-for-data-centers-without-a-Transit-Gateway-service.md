---
copyright:
  years: 2024
lastupdated: "2024-03-11"

subcollection: pattern-network-vrf-only

keywords:
# The release that the reference architecture describes

authors:
  - name: Vickie Hooper

version: 1.0

deployment-url:

docs: https://cloud.ibm.com/docs/pattern-network-vrf-only

content-type: reference-architecture
---

{{site.data.keyword.attribute-definition-list}}

# Network architecture
{: #network-vrf-only}
{: toc-content-type="reference-architecture"}
{: toc-version="1.0"}

This reference architecture is leveraged in DR scenarios where either the primary or DR site is a classic data center where {{site.data.keyword.vpc_short}} is not available. As of 1Q2024, the list includes centers such as Montreal 01, San Jose 03, San Jose 04, Chennai 01, and Hong Kong 02.

For a current list of Classic Data Centers, see [Classic Data Center locations](/docs/transit-gateway?topic=transit-gateway-tg-locations#szr-table).

This approach is refered to from now on as “Classic Data Center” because there is no VPC and TGW connectivity used.

It is a common approach to complement classic environments with VPC services. This approach allows additional functionality that is only available with VPC services. This document references this approach as “complementary VPC services” and it is highlighted throughout the pattern.

## Architecture diagram
{: #architecture-diagram}

This architecture describes on-premises data center connectivity into {{site.data.keyword.cloud_notm}} Classic, with firewall services and a {{site.data.keyword.powerSys_notm}} Workspace. The diagram includes examples to show where workload compute instances, proxy servers, and jump servers would reside. The diagram contains identifying numbers indicating key components in the description.

In this diagram, Region 1 represents a Classic Data Center where {{site.data.keyword.vpc_short}} is not available and Region 2 illustrates a Classic Data Center in a Multi-Zone Region where {{site.data.keyword.vpc_short}} is available.

![Illustrates a detailed network and component architecture for a
multi-region Classic Data Center solution architecture](cross-region-view.svg){: caption="Figure 5. Multi-Region View" caption-side="bottom"}
1.  Optional network path is accomplished through site-to-site VPN terminated on Classic Gateway.
2.  Client network connectivity from on-premises using {{site.data.keyword.dl_short}}.
3.  The gateway provides routing and security functions.
4.  Virtual Bastion host supports remote administrative access.
5.  GREa tunnel allows BYOIP to be advertised between Classic and on-premises. Two GRE tunnels allow for resiliency.
6.  GREb tunnel allows BYOIP to be advertised between Classic environments in separate regions. Two GRE tunnels allow for resiliency.
7.  GREc tunnel allows BYOIP to be advertised between Classic and PowerVS. Two GRE tunnels allow for resiliency.
8.  Private Cloud Service Endpoints (CSE) allow access to cloud services over the private network.
9.  The proxy Server acts as an intermediary between on-prem and cloud services.
10. Cloud Internet Services (CIS) is used to enhance the security, performance, and reliability of internet-facing applications and websites.
11. {{site.data.keyword.vpe_full}} as an alternative to CSE and Proxy server allow access to cloud services over the private network.
12. Custom DNS resolver in Classic is used for FQDN resolution.
13. DNS services on VPC as an alternative to custom DNS in classic.
14. In region 2 - TGW1 advertises and routes on-premise traffic to Classic for gateway or firewall inspection.
15. In region 2 - TGW2 advertises and routes local traffic between Classic, VPC, and PowerVS.
16. In region 2 - TGW3 advertises and routes Global traffic between regions for VPC and PowerVS.
17. {{site.data.keyword.loadbalancer_full}} provides local application load balancing.

## Design scope
{: #design-scope}

Following the [Architecture Framework](/docs/architecture-framework?topic=architecture-framework-taxonomy), the Classic Data Center network pattern covers design considerations and architecture decisions for the following aspects and domains:

-   **Compute:** Virtual Servers, Bare Metal Servers
-   **Networking:** Enterprise Connectivity, BYOIP/Edge Gateways, Network segmentation, Cloud Native Connectivity, Load Balancing, and DNS
-   **Security:** Identity and Access Management (IAM)
-   **Resiliency:** High Availability, Disaster Recovery
-   **Service management:** Monitoring, Logging, Auditing, Alerting, Event Management

![Illustrates a detailed network and component architecture for a
Classic Data Center solution architecture](heat_map.svg){: caption="Figure 2. Classic Data Center design scope" caption-side="bottom"}

The Architecture Framework provides a consistent approach to design cloud solutions by addressing requirements across a set of "aspects" and "domains", which are technology-agnostic architectural areas that need to be considered for any enterprise solution. See [Introduction to the architecture framework](/docs/architecture-framework?topic=architecture-framework-intro) for more details.

## Requirements
{: #requirements}

The following table represents a baseline set of requirements that are applicable to most clients and critical to successful Classic Data Center network deployment. The pattern assumes the client has a requirement of geolocation, data residency, or low latency that requires resource deployment in a data center that does not have transit gateway technology.

| **Aspect**         | **Requirement**                                                                                                                                                                                                                                                                                                    |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Compute            | fit-for-purpose compute hosts that meet the workload requirements.                                                                                                                                                                                                                              |
| Network            | Private enterprise connectivity from customer data centers to  {{site.data.keyword.cloud_notm}} for access to applications, data, and services.                                                                                                                                                                                            |
|                    | Private administrative and management connectivity                                                                                                                                                                                                                                                                 |
|                    | Provide network isolation with the ability to separate applications based on attributes such as data classification, public versus private traffic flows, and internal application function.                                                                                                                       |
|                    | Support Bring Your Own IP (BYOIP)                                                                                                                                                                                                                                                               |
| Security           | Firewalls must be restrictively configured to provide advanced security features and prevent all traffic, both inbound and outbound, except that which is required, documented, and approved and (optionally) include Intrusion Protection System (IPS) and Intrusion Detection System (IDS) services |
|                    | Distributed Denial of Service (DDoS) and Web Application Firewall (WAF) security capabilities required                                                                                                                                                                                                             |
|                    | Secure remote administrative support of all devices within the IBM Cloud environment.                                                                                                                                                                                                                                                 |
| Resiliency         | Multi-Region capability to support a disaster recovery strategy and solution that allows all production applications to be included by using cloud infrastructure DR strategies.                                                                                                                                   |
| Service management | Provide health and system monitoring with ability to monitor and correlate performance metrics and events and provide alerting across applications and infrastructure                                                                                                                                              |
|                    | Ability to diagnose issues and exceptions and identify error source                                                                                                                                                                                                                                                |
{: caption="Table 1. Classic Data Center requirements" caption-side="bottom"}

## Components
{: #components}

| **Aspect**             | **Component**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | **How the component is used**                                                                                                                                            |
|------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Compute                | [Virtual Server on Classic](/docs/virtual-servers?topic=virtual-servers-about-virtual-servers)  \n - Bastion Host                                                                                                                                                                                                                                                                                                                                                                                                                                                | Bastion host is deployed on a virtual server instance within classic and is used for remote administrative support                                                   |
|                        | [Virtual Server on Classic](/docs/virtual-servers?topic=virtual-servers-about-virtual-servers)  \n - Proxy Server                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Acts as an intermediary between the on-prem network and IBM cloud services.                                                                                   |
| Networking             | Virtual Private Network (VPN)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Provides a secured connection into  {{site.data.keyword.cloud_notm}} over the Internet. VPN can be used for migrations, administrative access, and backup connectivity. |
|                        | [**Gateway Appliance in Classic**](/docs/gateway-appliance?topic=gateway-appliance-getting-started-ga)  \n - [{{site.data.keyword.vsrx}}](/docs/vsrx?topic=vsrx-getting-started)  \n - [{{site.data.keyword.vra}}](/docs/virtual-router-appliance?topic=virtual-router-appliance-getting-started-vra)  \n - [FortiGate FSA 10 Gbps](/docs/fortigate-10g?topic=fortigate-10g-getting-started)  \n - [FortiGate vFSA](/docs/vfsa?topic=vfsa-getting-started) \n - Bring Your Own Gateway ([BYOG](/docs/gateway-appliance?topic=gateway-appliance-order-byoa))  \n BM or VSI (Checkpoint, Cisco, and Palo Alto) | Provides router, firewall, and VPN gateway functions for secure and reliable connectivity to cloud resources.                                                            |
|                        | Generic Routing Encapsulation (GRE) tunnels                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Supports Bring Your Own IP (BYOIP) communication between on-premise, Classic Infrastructure, and {{site.data.keyword.powerSys_notm}} Workspace.                                                                |
|                        | [{{site.data.keyword.dl_short}}](/docs/dl?topic=dl-get-started-with-ibm-cloud-dl)  \n - {{site.data.keyword.dl_short}} Connect                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Connect on-premise networks to the  {{site.data.keyword.cloud_notm}} with physical telco connections or virtual exchange network services.                                                              |
|                        | [Load Balancers](/catalog/infrastructure/load-balancer-group)   \n - {{site.data.keyword.loadbalancer_full}}  \n - {{site.data.keyword.cis_short}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Local and global Application Load Balancing for web servers, app servers, and database servers as needed.                                                                                            |
|                        | [Service Endpoints](/docs/account?topic=account-vrf-service-endpoint&interface=ui#use-service-endpoint)                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Connect directly to cloud services without using the public network.                                                                                                      |
|                        | [{{site.data.keyword.cis_short}}](/docs-draft/cis?topic=cis-getting-started)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Public Load balancing of web server traffic across regions.                                                                                                               |
|                        | Custom DNS server (VSI)  \n or  \n [DNS Services (VPC)](/docs/dns-svcs?topic=dns-svcs-getting-started)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | The Domain Name System (DNS) to associate human-friendly domain names with IP addresses.                                                                                  |
| **Security**           | [IAM](/docs-draft/account?topic=account-cloudaccess)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |  {{site.data.keyword.cloud_notm}} Identity & Access Management.                                                                                                                                   |
|                        | [{{site.data.keyword.cis_short}}](/docs-draft/cis?topic=cis-getting-started)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | DDoS protection and Web Application Firewall (WAF) for public connectivity.                                                                                               |
|                        | [Gateway Appliance in Classic](/docs/gateway-appliance?topic=gateway-appliance-getting-started-ga)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Advanced firewall capabilities such as Intrusion Detection System (IDS) and Intrusion Protection System (IPS) services.                                                     |
|                        | Bastion Host                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Bastion Host is deployed on a virtual server instance within classic and is used for remote administrative support.                                                   |
| **Resiliency**         | Multi-Region Deployment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Allows for disaster recovery in a secondary region.                                                                                                                         |
|                        | Multiple {{site.data.keyword.dl_short}} connections                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Allows for network resiliency for failover and recovery.                                                                                                                    |
| **Service management** | Health Dashboard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Apps and operational monitoring.                                                                                                                                          |
{: caption="Table 2. Classic Data Center solution components"}
